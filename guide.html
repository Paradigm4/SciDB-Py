
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>User Guide &#8212; SciDB-Py 18.1 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '18.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API" href="api.html" />
    <link rel="prev" title="SciDB-Py Documentation" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-scidbpy">
<span id="user-guide"></span><h1>User Guide<a class="headerlink" href="#module-scidbpy" title="Permalink to this headline">¶</a></h1>
<div class="section" id="quick-start">
<h2>Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h2>
<p>Install the package with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ pip install scidb-py
</pre></div>
</div>
<p>Connect to SciDB and run a query:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scidbpy</span> <span class="k">import</span> <span class="n">connect</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="s1">&#39;http://localhost:8080&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s1">&#39;store(build(&lt;x:int64&gt;[i=0:2], i), foo)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Download data from SciDB:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="p">[:]</span>
<span class="go">   i    x</span>
<span class="go">0  0  0.0</span>
<span class="go">1  1  1.0</span>
<span class="go">2  2  2.0</span>
</pre></div>
</div>
<p>Upload data to SciDB and create an array:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">upload_data</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">store</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span>
<span class="gp">... </span>
<span class="go">py_..._1</span>
</pre></div>
</div>
<p>Run a query with chained operators and download the resulting array:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="n">ar</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)[:]</span>
<span class="go">   i  x  x_1  j</span>
<span class="go">0  0  0  0.0  1</span>
<span class="go">1  1  1  1.0  2</span>
<span class="go">2  2  2  2.0  3</span>
</pre></div>
</div>
<p>Operators can also be composed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ar</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">),</span> <span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="n">ar</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)[:]</span>
<span class="go">   i  x  x_1  j</span>
<span class="go">0  0  0  0.0  1</span>
<span class="go">1  1  1  1.0  2</span>
<span class="go">2  2  2  2.0  3</span>
</pre></div>
</div>
<p>Cleanup:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">ar</span>
</pre></div>
</div>
</div>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>SciDB <code class="docutils literal"><span class="pre">16.9</span></code> or newer with Shim</p>
<p>Python <code class="docutils literal"><span class="pre">2.7.x</span></code>, <code class="docutils literal"><span class="pre">3.4.x</span></code>, <code class="docutils literal"><span class="pre">3.5.x</span></code>, <code class="docutils literal"><span class="pre">3.6.x</span></code> or newer.</p>
<p>Required Python packages:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">backports</span><span class="o">.</span><span class="n">weakref</span>
<span class="n">enum34</span>
<span class="n">numpy</span>
<span class="n">pandas</span>
<span class="n">requests</span>
<span class="n">six</span>
</pre></div>
</div>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Install latest release:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ pip install scidb-py
</pre></div>
</div>
<p>Install development version from GitHub:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ pip install git+http://github.com/paradigm4/scidb-py.git
</pre></div>
</div>
</div>
<div class="section" id="connect-to-scidb">
<h2>Connect to SciDB<a class="headerlink" href="#connect-to-scidb" title="Permalink to this headline">¶</a></h2>
<p>Connect to SciDB using <a class="reference internal" href="api.html#scidbpy.db.connect" title="scidbpy.db.connect"><code class="xref py py-func docutils literal"><span class="pre">connect()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scidbpy</span> <span class="k">import</span> <span class="n">connect</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span> <span class="o">=</span> <span class="n">connect</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="s1">&#39;http://localhost:8080&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">connect()</span></code> is aliased to the constructor of the
<a class="reference internal" href="api.html#scidbpy.db.DB" title="scidbpy.db.DB"><code class="xref py py-class docutils literal"><span class="pre">DB</span></code></a> class. See <a class="reference internal" href="api.html#scidbpy.db.DB" title="scidbpy.db.DB"><code class="xref py py-meth docutils literal"><span class="pre">DB()</span></code></a> for
the complete set of arguments that can be provided to
<code class="docutils literal"><span class="pre">connect</span></code>. <code class="docutils literal"><span class="pre">http://localhost:8080</span></code> is the default connection URL
is none is provided.</p>
<p>Display information about the <code class="docutils literal"><span class="pre">db</span></code> object:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span>
<span class="go">DB(&#39;http://localhost:8080&#39;, None, None, None, None)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
<span class="go">scidb_url  = http://localhost:8080</span>
<span class="go">scidb_auth = None</span>
<span class="go">http_auth  = None</span>
<span class="go">namespace  = None</span>
<span class="go">verify     = None</span>
</pre></div>
</div>
<div class="section" id="advanced-connection">
<h3>Advanced Connection<a class="headerlink" href="#advanced-connection" title="Permalink to this headline">¶</a></h3>
<p>Provide <a class="reference external" href="https://github.com/Paradigm4/shim">Shim</a> credentials:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="n">http_auth</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span>
<span class="go">DB(&#39;http://localhost:8080&#39;, None, (&#39;foo&#39;, PASSWORD_PROVIDED), None, None)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
<span class="go">scidb_url  = http://localhost:8080</span>
<span class="go">scidb_auth = None</span>
<span class="go">http_auth  = (&#39;foo&#39;, PASSWORD_PROVIDED)</span>
<span class="go">namespace  = None</span>
<span class="go">verify     = None</span>
</pre></div>
</div>
<p>To prompt the user for the password, use:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">getpass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="n">http_auth</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getpass</span><span class="p">()))</span>
<span class="gp">... </span>
<span class="go">Password:</span>
</pre></div>
</div>
<p>Use SSL:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db_ssl</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="s1">&#39;https://localhost:8083&#39;</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db_ssl</span><span class="p">)</span>
<span class="go">scidb_url  = https://localhost:8083</span>
<span class="go">scidb_auth = None</span>
<span class="go">http_auth  = None</span>
<span class="go">namespace  = None</span>
<span class="go">verify     = False</span>
</pre></div>
</div>
<p>See Python <a class="reference external" href="http://docs.python-requests.org/en/master/">requests</a>
library <a class="reference external" href="http://docs.python-requests.org/en/master/user/advanced/#ssl-cert-verification">SSL Cert Verification</a> section for details on the <code class="docutils literal"><span class="pre">verify</span></code>
argument. <code class="docutils literal"><span class="pre">verify=False</span></code> disables SSL certificate
verification. Warnings about the unverified HTTPS requests are
displayed. The warnings can be disabled as well by either setting
<code class="docutils literal"><span class="pre">PYTHONWARNINGS=&quot;ignore:Unverified</span> <span class="pre">HTTPS</span> <span class="pre">request&quot;</span></code> in the
environment before starting Python or by doing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">requests</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">requests</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">(</span>
<span class="gp">... </span>  <span class="n">requests</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">urllib3</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">InsecureRequestWarning</span><span class="p">)</span>
</pre></div>
</div>
<p>Use SSL and SciDB credentials:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db_ssl</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span>
<span class="gp">... </span>  <span class="s1">&#39;https://localhost:8083&#39;</span><span class="p">,</span> <span class="n">scidb_auth</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">),</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db_ssl</span><span class="p">)</span>
<span class="go">scidb_url  = https://localhost:8083</span>
<span class="go">scidb_auth = (&#39;foo&#39;, PASSWORD_PROVIDED)</span>
<span class="go">http_auth  = None</span>
<span class="go">namespace  = None</span>
<span class="go">verify     = False</span>
</pre></div>
</div>
<p>By default, the <code class="docutils literal"><span class="pre">connect</span></code> function queries SciDB for the list of
available operators. This list is used for easy access to the SciDB
operators, see the <em>SciDB Operators</em> section below. As a consequence
the connection to SciDB is verified and a small delay might
occur. This behavior can be disabled using the <code class="docutils literal"><span class="pre">no_ops=True</span></code>
parameter. Accessing the SciDB operators as described in <em>SciDB
Operators</em> will not be possible until the <code class="docutils literal"><span class="pre">load_ops()</span></code> function is
called on the <code class="docutils literal"><span class="pre">DB</span></code> instance:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db_no_ops</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="n">no_ops</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db_no_ops</span><span class="o">.</span><span class="n">scan</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;DB&#39; object has no attribute &#39;scan&#39;</span>
</pre></div>
</div>
<p>No query has been issued to SciDB yet.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db_no_ops</span><span class="o">.</span><span class="n">load_ops</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db_no_ops</span><span class="o">.</span><span class="n">scan</span>
<span class="gp">... </span>
<span class="go">Operator(db=DB(&#39;http://localhost:8080&#39;, None, None, None, None),</span>
<span class="go">         name=&#39;scan&#39;,</span>
<span class="go">         args=[])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="scidb-arrays">
<h2>SciDB Arrays<a class="headerlink" href="#scidb-arrays" title="Permalink to this headline">¶</a></h2>
<p>SciDB arrays can be accessed using <code class="docutils literal"><span class="pre">DB.arrays</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span> <span class="o">=</span> <span class="n">connect</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s1">&#39;store(build(&lt;x:int64&gt;[i=0:2], i), foo)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="p">)</span>
<span class="gp">... </span>
<span class="go">[u&#39;foo&#39;]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="p">)</span>
<span class="gp">... </span>
<span class="go">[u&#39;i&#39;, u&#39;x&#39;]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="p">[:]</span>
<span class="go">   i    x</span>
<span class="go">0  0  0.0</span>
<span class="go">1  1  1.0</span>
<span class="go">2  2  2.0</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">][:]</span>
<span class="go">   i    x</span>
<span class="go">0  0  0.0</span>
<span class="go">1  1  1.0</span>
<span class="go">2  2  2.0</span>
</pre></div>
</div>
<p>To get the schema of an array, we can use the <code class="docutils literal"><span class="pre">schema</span></code> utility
function:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">schema</span><span class="p">())</span>
<span class="go">foo&lt;x:int64&gt; [i=0:2:0:1000000]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span><span class="o">.</span><span class="n">pprint</span><span class="p">()</span>
<span class="gp">... </span>
<span class="go">foo&lt;x:int64&gt; [i=0:2:0:1000000]</span>
<span class="go">  name class   type nullable start end overlap    chunk</span>
<span class="go">0    x  attr  int64     True</span>
<span class="go">1    i   dim  int64              0   2       0  1000000</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s1">&#39;remove(foo)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>Arrays specified explicitly are not checked:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="p">)</span>
<span class="go">foo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">bar</span><span class="p">)</span>
<span class="go">bar</span>
</pre></div>
</div>
<p>In IPython, we can use &lt;TAB&gt; for auto-completion of array names,
array dimensions, and array attributes:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.&lt;</span><span class="n">TAB</span><span class="o">&gt;</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="o">.&lt;</span><span class="n">TAB</span><span class="o">&gt;</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
</div>
<div class="section" id="scidb-operators">
<h2>SciDB Operators<a class="headerlink" href="#scidb-operators" title="Permalink to this headline">¶</a></h2>
<p>At connection time, the library downloads the list of available SciDB
operators and macros and makes them available through the <code class="docutils literal"><span class="pre">DB</span></code> class
instance:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
<span class="gp">... </span>
<span class="go">[u&#39;aggregate&#39;,</span>
<span class="go"> ...</span>
<span class="go"> u&#39;xgrid&#39;]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">apply</span>
<span class="gp">... </span>
<span class="go">Operator(db=DB(&#39;http://localhost:8080&#39;, None, None, None, None),</span>
<span class="go">         name=&#39;apply&#39;,</span>
<span class="go">         args=[])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">apply</span><span class="p">)</span>
<span class="go">apply()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">missing</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;DB&#39; object has no attribute &#39;missing&#39;</span>
</pre></div>
</div>
<p>In IPython, we can use &lt;TAB&gt; for auto-completion of operator names:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">db</span><span class="o">.&lt;</span><span class="n">TAB</span><span class="o">&gt;</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">db</span><span class="o">.</span><span class="n">apply</span>
</pre></div>
</div>
<p>The operators can be execute immediately or can be lazy and executed
at a later time. Operators that return arrays are lazy operators (e.g.,
<code class="docutils literal"><span class="pre">apply</span></code>, <code class="docutils literal"><span class="pre">scan</span></code>, etc.). Operator which do not return arrays
execute immediately (e.g., <code class="docutils literal"><span class="pre">create_array</span></code>, <code class="docutils literal"><span class="pre">remove</span></code>, etc.).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">create_array</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;x:int64&gt;[i]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="p">)</span>
<span class="gp">... </span>
<span class="go">[u&#39;foo&#39;]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>The list of available operators is re-loaded automatically when
a <code class="docutils literal"><span class="pre">load_library</span></code> query is issued:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">load_library</span><span class="p">(</span><span class="s1">&#39;limit&#39;</span><span class="p">)</span>
<span class="gp">... </span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;limit&#39;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
<span class="gp">... </span>
<span class="go">True</span>
</pre></div>
</div>
<p>A similar functionality is <strong>not</strong> implemented for <code class="docutils literal"><span class="pre">unload_library</span></code>
operator. The <code class="docutils literal"><span class="pre">unload_library</span></code> operator requires a SciDB restart,
which makes re-loading the list of operators not
practical. Nevertheless, one can trigger the re-loading manually after
SciDB restart without creating a new <code class="docutils literal"><span class="pre">DB</span></code> instance:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s2">&quot;unload_library(&#39;limit&#39;)&quot;</span><span class="p">)</span>
<span class="gp">... </span>
</pre></div>
</div>
<p>After SciDB restart:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">load_ops</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;limit&#39;</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
<span class="gp">... </span>
<span class="go">False</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">cross_join</span></code> operator in SciDB supports aliasing for the array
arguments, e.g., <code class="docutils literal"><span class="pre">cross_join(left_array</span> <span class="pre">as</span> <span class="pre">left_alias,...</span></code>. Aliasing
is possible in SciDB-Py using the <code class="docutils literal"><span class="pre">%</span></code> operator:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s1">&#39;store(build(&lt;x:int64&gt;[i=0:1], i), foo)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">cross_join</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span> <span class="o">%</span> <span class="s1">&#39;f1&#39;</span><span class="p">,</span>
<span class="gp">... </span>              <span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span> <span class="o">%</span> <span class="s1">&#39;f2&#39;</span><span class="p">,</span>
<span class="gp">... </span>              <span class="s1">&#39;f1.i&#39;</span><span class="p">,</span> <span class="s1">&#39;f2.i&#39;</span><span class="p">)[:]</span>
<span class="go">   i    x  x_1</span>
<span class="go">0  0  0.0  0.0</span>
<span class="go">1  1  1.0  1.0</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="p">)</span>
</pre></div>
</div>
<p>To retrieve the schema of a query result, the <code class="docutils literal"><span class="pre">schema</span></code> utility
function can be used:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s1">&#39;&lt;x:int64&gt;[i=0:2]&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">schema</span><span class="p">())</span>
<span class="go">build&lt;x:int64&gt; [i=0:2:0:1000000]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s1">&#39;&lt;x:int64&gt;[i=0:2]&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">schema</span><span class="p">()</span><span class="o">.</span><span class="n">pprint</span><span class="p">()</span>
<span class="gp">... </span>
<span class="go">build&lt;x:int64&gt; [i=0:2:0:1000000]</span>
<span class="go">  name class   type nullable start end overlap    chunk</span>
<span class="go">0    x  attr  int64     True</span>
<span class="go">1    i   dim  int64              0   2       0  1000000</span>
</pre></div>
</div>
<div class="section" id="download-data-from-scidb">
<h3>Download Data from SciDB<a class="headerlink" href="#download-data-from-scidb" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s1">&#39;&lt;x:int8 not null&gt;[i=0:2]&#39;</span><span class="p">,</span> <span class="s1">&#39;i + 10&#39;</span><span class="p">)[:]</span>
<span class="go">   i   x</span>
<span class="go">0  0  10</span>
<span class="go">1  1  11</span>
<span class="go">2  2  12</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s1">&#39;&lt;x:int8 not null&gt;[i=0:2]&#39;</span><span class="p">,</span> <span class="s1">&#39;i + 10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">as_dataframe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">... </span>
<span class="go">array([(0, 10), (1, 11), (2, 12)],</span>
<span class="go">      dtype=[(&#39;i&#39;, &#39;&lt;i8&#39;), (&#39;x&#39;, &#39;i1&#39;)])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s1">&#39;&lt;x:int8 not null&gt;[i=0:2]&#39;</span><span class="p">,</span> <span class="s1">&#39;i + 10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">atts_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    x</span>
<span class="go">0  10</span>
<span class="go">1  11</span>
<span class="go">2  12</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s1">&#39;&lt;x:int8 not null&gt;[i=0:2]&#39;</span><span class="p">,</span> <span class="s1">&#39;i + 10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x - 5&#39;</span><span class="p">)[:]</span>
<span class="go">   i   x  y</span>
<span class="go">0  0  10  5</span>
<span class="go">1  1  11  6</span>
<span class="go">2  2  12  7</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s1">&#39;&lt;x:int8 not null&gt;[i=0:2]&#39;</span><span class="p">,</span> <span class="s1">&#39;i + 10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="go">Array(DB(&#39;http://localhost:8080&#39;, None, None, None, None), &#39;foo&#39;)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="p">)[:]</span>
<span class="go">   i   x</span>
<span class="go">0  0  10</span>
<span class="go">1  1  11</span>
<span class="go">2  2  12</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)[:]</span>
<span class="go">   i   x   y</span>
<span class="go">0  0  10  11</span>
<span class="go">1  1  11  12</span>
<span class="go">2  2  12  13</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="upload-data-to-scidb">
<h3>Upload Data to SciDB<a class="headerlink" href="#upload-data-to-scidb" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">input</span></code> and <code class="docutils literal"><span class="pre">load</span></code> operators can be used to upload data. An upload
schema can also be provided. If the resulting array or schema is not
provided, it can be generated from the upload data or upload
schema. If the upload format is not provided, it can be constructed
from the upload schema, upload data, or resulting array schema.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="s1">&#39;&lt;x:int64&gt;[i]&#39;</span><span class="p">,</span> <span class="n">upload_data</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">))[:]</span>
<span class="go">   i    x</span>
<span class="go">0  0  0.0</span>
<span class="go">1  1  1.0</span>
<span class="go">2  2  2.0</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="s1">&#39;&lt;x:int64&gt;[i]&#39;</span><span class="p">,</span> <span class="n">upload_data</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="p">)</span>
<span class="go">Array(DB(&#39;http://localhost:8080&#39;, None, None, None, None), &#39;foo&#39;)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="n">upload_data</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">Array(DB(&#39;http://localhost:8080&#39;, None, None, None, None), &#39;foo&#39;)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="s1">&#39;&lt;x:int64&gt;[j]&#39;</span><span class="p">,</span> <span class="n">upload_data</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">... </span> <span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j + 3&#39;</span>
<span class="gp">... </span> <span class="p">)</span><span class="o">.</span><span class="n">redimension</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span>
<span class="gp">... </span> <span class="p">)</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="p">[:]</span>
<span class="go">   i    x</span>
<span class="go">0  0  0.0</span>
<span class="go">1  1  1.0</span>
<span class="go">2  2  2.0</span>
<span class="go">3  3  3.0</span>
<span class="go">4  4  4.0</span>
<span class="go">5  5  5.0</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="s1">&#39;&lt;i:int64 not null, x:int64&gt;[j]&#39;</span><span class="p">,</span>
<span class="gp">... </span>         <span class="n">upload_data</span><span class="o">=</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">as_dataframe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">... </span> <span class="p">)</span><span class="o">.</span><span class="n">redimension</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span>
<span class="gp">... </span> <span class="p">)</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
<span class="go">Array(DB(&#39;http://localhost:8080&#39;, None, None, None, None), &#39;bar&#39;)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">numpy</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">bar</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">as_dataframe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">... </span>          <span class="o">==</span> <span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">as_dataframe</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">buf</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">bytes</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">])],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="s1">&#39;&lt;b:binary not null&gt;[i]&#39;</span><span class="p">,</span> <span class="n">upload_data</span><span class="o">=</span><span class="n">buf</span><span class="p">)</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="s1">&#39;taz&#39;</span><span class="p">)</span>
<span class="go">Array(DB(&#39;http://localhost:8080&#39;, None, None, None, None), &#39;taz&#39;)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;taz&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">upload_data</span><span class="o">=</span><span class="n">buf</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">upload_schema</span><span class="o">=</span><span class="n">Schema</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="s1">&#39;&lt;b:binary not null&gt;[i]&#39;</span><span class="p">))</span>
<span class="go">Array(DB(&#39;http://localhost:8080&#39;, None, None, None, None), &#39;taz&#39;)</span>
</pre></div>
</div>
<p>For files already available on the server the <code class="docutils literal"><span class="pre">input</span></code> or <code class="docutils literal"><span class="pre">load</span></code>
operators can be invoked with the full set of arguments supported by
SciDB. Arguments that need to be quoted in SciDB need to be
double-quoted in SciDB-Py. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s2">&quot;&#39;/data.csv&#39;&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&#39;CSV&#39;&quot;</span><span class="p">)</span>
<span class="gp">... </span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">ar</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;taz&#39;</span><span class="p">]:</span> <span class="n">db</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">store</span></code> function accepts a <code class="docutils literal"><span class="pre">temp</span></code> argument as well. If the
<code class="docutils literal"><span class="pre">temp</span></code> argument is set to <code class="docutils literal"><span class="pre">True</span></code>, a temporary array is created.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="s1">&#39;&lt;x:int64&gt;[i=0:2]&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">list</span><span class="p">()[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;temporary&#39;</span><span class="p">]]</span>
<span class="go">  name  temporary</span>
<span class="go">0  foo       True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span>
</pre></div>
</div>
<p>If an array name is not specified for the <code class="docutils literal"><span class="pre">store</span></code> operator, an array
name is generated. Arrays with generated names are removed when the
returned Array object is garbage collected. This behavior can be
changed by specifying the <code class="docutils literal"><span class="pre">gc=False</span></code> argument to the store operator.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">upload_data</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">store</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span>
<span class="gp">... </span>
<span class="go">Array(DB(&#39;http://localhost:8080&#39;, None, None, None, None), &#39;py_...&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">ar</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="the-iquery-function">
<h2>The iquery Function<a class="headerlink" href="#the-iquery-function" title="Permalink to this headline">¶</a></h2>
<p>Use the <a class="reference internal" href="api.html#scidbpy.db.DB.iquery" title="scidbpy.db.DB.iquery"><code class="xref py py-meth docutils literal"><span class="pre">DB.iquery()</span></code></a> function to execute
literal queries against SciDB:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s1">&#39;store(build(&lt;x:int64&gt;[i=0:2], i), foo)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id1">
<h3>Download Data from SciDB<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">iquery</span></code> function can be used to download data from SciDB by
specifying the <code class="docutils literal"><span class="pre">fetch=True</span></code> argument:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s1">&#39;scan(foo)&#39;</span><span class="p">,</span> <span class="n">fetch</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">   i    x</span>
<span class="go">0  0  0.0</span>
<span class="go">1  1  1.0</span>
<span class="go">2  2  2.0</span>
</pre></div>
</div>
<p>To avoid downloading the dimension information and only download the
attributes, use the <code class="docutils literal"><span class="pre">atts_only=True</span></code> argument:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s1">&#39;scan(foo)&#39;</span><span class="p">,</span> <span class="n">fetch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">atts_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">     x</span>
<span class="go">0  0.0</span>
<span class="go">1  1.0</span>
<span class="go">2  2.0</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s1">&#39;remove(foo)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Download operator output directly:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s1">&#39;build(&lt;x:int64 not null&gt;[i=0:2], i)&#39;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">fetch</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">   i  x</span>
<span class="go">0  0  0</span>
<span class="go">1  1  1</span>
<span class="go">2  2  2</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s1">&#39;build(&lt;x:int64 not null&gt;[i=0:2], i)&#39;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">fetch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">atts_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">   x</span>
<span class="go">0  0</span>
<span class="go">1  1</span>
<span class="go">2  2</span>
</pre></div>
</div>
<p>If dimension names collide with attribute names, unique dimension
names are created:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s1">&#39;apply(build(&lt;x:int64 not null&gt;[i=0:2], i), i, i)&#39;</span><span class="p">,</span> <span class="n">fetch</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">   i_1  x  i</span>
<span class="go">0    0  0  0</span>
<span class="go">1    1  1  1</span>
<span class="go">2    2  2  2</span>
</pre></div>
</div>
<p>If schema is known, it can be provided to <code class="docutils literal"><span class="pre">iquery</span></code> using the
<code class="docutils literal"><span class="pre">schema</span></code> argument. This speeds up the execution as <code class="docutils literal"><span class="pre">iquery</span></code> does
not need to issue a <code class="docutils literal"><span class="pre">show()</span></code> query first in order to determine the
schema:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scidbpy</span> <span class="k">import</span> <span class="n">Schema</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iquery</span><span class="p">(</span><span class="n">db</span><span class="p">,</span>
<span class="gp">... </span>       <span class="s1">&#39;build(&lt;x:int64 not null&gt;[i=0:2], i)&#39;</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">fetch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">schema</span><span class="o">=</span><span class="n">Schema</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="p">(</span><span class="n">Attribute</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="n">not_null</span><span class="o">=</span><span class="kc">True</span><span class="p">),),</span>
<span class="gp">... </span>                     <span class="p">(</span><span class="n">Dimension</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),)))</span>
<span class="go">   i  x</span>
<span class="go">0  0  0</span>
<span class="go">1  1  1</span>
<span class="go">2  2  2</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">iquery</span><span class="p">(</span><span class="n">db</span><span class="p">,</span>
<span class="gp">... </span>       <span class="s1">&#39;build(&lt;x:int64 not null&gt;[i=0:2], i)&#39;</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">fetch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">atts_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">schema</span><span class="o">=</span><span class="n">Schema</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="s1">&#39;&lt;x:int64 not null&gt;[i=0:2]&#39;</span><span class="p">))</span>
<span class="gp">... </span>
<span class="go">   x</span>
<span class="go">0  0</span>
<span class="go">1  1</span>
<span class="go">2  2</span>
</pre></div>
</div>
<p>Attributes with null-able types are promoted as per Pandas ‘promotion
scheme &lt;<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/gotchas.html">http://pandas.pydata.org/pandas-docs/stable/gotchas.html</a>
#na-type-promotions&gt;`_ During such promotions, precision loss might
occur. The user is notified about this via a <code class="docutils literal"><span class="pre">UserWarning</span></code>. If
desired, such warnings can be disabled as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span> <span class="o">=</span> <span class="ne">UserWarning</span><span class="p">)</span>
</pre></div>
</div>
<p>Type promotions can be avoided altogether, by specifying
<code class="docutils literal"><span class="pre">dataframe_promo</span> <span class="pre">=</span> <span class="pre">False</span></code> in the <code class="docutils literal"><span class="pre">iquery</span></code> arguments. In this case,
object records will be used instead of atomic values:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">iquery</span><span class="p">(</span><span class="n">db</span><span class="p">,</span>
<span class="gp">... </span>       <span class="s1">&#39;build(&lt;x:int64&gt;[i=0:2], i)&#39;</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">fetch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">atts_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">dataframe_promo</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">... </span>
<span class="go">   x</span>
<span class="go">0  (255, 0)</span>
<span class="go">1  (255, 1)</span>
<span class="go">2  (255, 2)</span>
</pre></div>
</div>
<p>Download as NumPy Array:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">iquery</span><span class="p">(</span><span class="n">db</span><span class="p">,</span>
<span class="gp">... </span>       <span class="s1">&#39;build(&lt;x:int64&gt;[i=0:2], i)&#39;</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">fetch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">... </span>
<span class="go">array([(0, (255, 0)), (1, (255, 1)), (2, (255, 2))],</span>
<span class="go">      dtype=[(&#39;i&#39;, &#39;&lt;i8&#39;), (&#39;x&#39;, [(&#39;null&#39;, &#39;u1&#39;), (&#39;val&#39;, &#39;&lt;i8&#39;)])])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">iquery</span><span class="p">(</span><span class="n">db</span><span class="p">,</span>
<span class="gp">... </span>       <span class="s1">&#39;build(&lt;x:int64&gt;[i=0:2], i)&#39;</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">fetch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">atts_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">as_dataframe</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">... </span>
<span class="go">array([((255, 0),), ((255, 1),), ((255, 2),)],</span>
<span class="go">      dtype=[(&#39;x&#39;, [(&#39;null&#39;, &#39;u1&#39;), (&#39;val&#39;, &#39;&lt;i8&#39;)])])</span>
</pre></div>
</div>
<p>If the <a class="reference external" href="https://github.com/Paradigm4/accelerated_io_tools">accelerated_io_tools</a> SciDB plugin is
installed and enabled in <a class="reference external" href="https://github.com/Paradigm4/shim">Shim</a>,
SciDB arrays can be downloaded using the Apache Arrow library:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s1">&#39;scan(foo)&#39;</span><span class="p">,</span> <span class="n">fetch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_arrow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>
<span class="go">   i    x</span>
<span class="go">0  0  0.0</span>
<span class="go">1  1  1.0</span>
<span class="go">2  2  2.0</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h3>Upload Data to SciDB<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Data can be uploaded using the <code class="docutils literal"><span class="pre">iquery</span></code> function by providing an
<code class="docutils literal"><span class="pre">upload_data</span></code> argument. A file name placeholder needs to be provided
as part of the SciDB query string. The upload array schema and data
format can be provided explicitly or as placeholders in the query
string. The placeholders are replaced with the explicit values by the
<code class="docutils literal"><span class="pre">iquery</span></code> function, before the query is sent to SciDB.</p>
<p>The SciDB query placeholders are:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">'{fn}'</span></code>: <strong>mandatory</strong> placeholder which is replaced with the
file name of the server file where the uploaded data is stored. It
has to be <em>quoted</em> with single quotes in the query string.</li>
<li><code class="docutils literal"><span class="pre">{sch}</span></code>: <em>optional</em> placeholder which is replaced with the upload
array schema. It does <em>not</em> need to be quoted.</li>
<li><code class="docutils literal"><span class="pre">'{fmt}'</span></code>: <em>optional</em> placeholder which is replaced with the
upload array format.  It has to be <em>quoted</em> with single quotes in
the query string.</li>
</ul>
<p>See examples in the following subsections.</p>
<div class="section" id="upload-numpy-arrays">
<h4>Upload NumPy Arrays<a class="headerlink" href="#upload-numpy-arrays" title="Permalink to this headline">¶</a></h4>
<p>Provide a SciDB <code class="docutils literal"><span class="pre">input</span></code>, <code class="docutils literal"><span class="pre">store</span></code>, <code class="docutils literal"><span class="pre">insert</span></code>, or <code class="docutils literal"><span class="pre">load</span></code> query
and a NumPy array. If the schema or format are provided as
placeholders, the upload data <em>dtype</em> or upload schema is used to
populate these placeholders.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s2">&quot;store(input(&lt;x:int64&gt;[i], &#39;</span><span class="si">{fn}</span><span class="s2">&#39;, 0, &#39;</span><span class="si">{fmt}</span><span class="s2">&#39;), foo)&quot;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">upload_data</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="p">[:]</span>
<span class="go">   i    x</span>
<span class="go">0  0  0.0</span>
<span class="go">1  1  1.0</span>
<span class="go">2  2  2.0</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s2">&quot;insert(input(</span><span class="si">{sch}</span><span class="s2">, &#39;</span><span class="si">{fn}</span><span class="s2">&#39;, 0, &#39;(int64)&#39;), foo)&quot;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">upload_data</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<p>Optionally, a <code class="docutils literal"><span class="pre">Schema</span></code> object can be used to specify the upload
schema using the <code class="docutils literal"><span class="pre">upload_schema</span></code> argument:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s2">&quot;load(foo, &#39;</span><span class="si">{fn}</span><span class="s2">&#39;, 0, &#39;</span><span class="si">{fmt}</span><span class="s2">&#39;)&quot;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">upload_data</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
<span class="gp">... </span>          <span class="n">upload_schema</span><span class="o">=</span><span class="n">Schema</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="s1">&#39;&lt;x:int64 not null&gt;[i]&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="upload-binary-data">
<h4>Upload Binary Data<a class="headerlink" href="#upload-binary-data" title="Permalink to this headline">¶</a></h4>
<p>Provide a SciDB <code class="docutils literal"><span class="pre">input</span></code>, <code class="docutils literal"><span class="pre">store</span></code>, <code class="docutils literal"><span class="pre">insert</span></code>, or <code class="docutils literal"><span class="pre">load</span></code> query
and binary data. The schema of the upload data needs to be provided
either explicitly in the query string or using the <code class="docutils literal"><span class="pre">upload_schema</span></code>
argument. If the schema is not provides using the <code class="docutils literal"><span class="pre">upload_schema</span></code>
argument, the format needs to be provided explicitly in the query
string:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s2">&quot;store(input(</span><span class="si">{sch}</span><span class="s2">, &#39;</span><span class="si">{fn}</span><span class="s2">&#39;, 0, &#39;</span><span class="si">{fmt}</span><span class="s2">&#39;), foo)&quot;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">upload_data</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">tobytes</span><span class="p">(),</span>
<span class="gp">... </span>          <span class="n">upload_schema</span><span class="o">=</span><span class="n">Schema</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="s1">&#39;&lt;x:int64 not null&gt;[i]&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s2">&quot;insert(input(foo, &#39;</span><span class="si">{fn}</span><span class="s2">&#39;, 0, &#39;(int64)&#39;), foo)&quot;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">upload_data</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">tobytes</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s2">&quot;load(foo, &#39;</span><span class="si">{fn}</span><span class="s2">&#39;, 0, &#39;(int64)&#39;)&quot;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">upload_data</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">tobytes</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="upload-data-files">
<h4>Upload Data Files<a class="headerlink" href="#upload-data-files" title="Permalink to this headline">¶</a></h4>
<p>A binary or text file-like object can be used to specify the upload
data. The content of the file has to be in one of the <a class="reference external" href="https://paradigm4.atlassian.net/wiki/spaces/ESD169/pages/50856232/input">supported SciDB
formats</a>. A
matching format specification has to be provided as well:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;array.bin&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">n</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">tobytes</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s2">&quot;load(foo, &#39;</span><span class="si">{fn}</span><span class="s2">&#39;, 0, &#39;(int64)&#39;)&quot;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">upload_data</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;array.bin&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;array.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">n</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;1</span><span class="se">\n</span><span class="s1">2</span><span class="se">\n</span><span class="s1">3</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s2">&quot;load(foo, &#39;</span><span class="si">{fn}</span><span class="s2">&#39;, 0, &#39;CSV&#39;)&quot;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">upload_data</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;array.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;array.bin&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;array.csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">arrays</span><span class="o">.</span><span class="n">foo</span><span class="p">)</span>
</pre></div>
</div>
<p>Please note that the data file is not read into the SciDB-Py
library. The data file object is passed directly to the <code class="docutils literal"><span class="pre">requests</span></code>
library which handles the HTTP communication with <em>Shim</em>.</p>
</div>
</div>
</div>
<div class="section" id="scidb-enterprise-edition-features">
<h2>SciDB Enterprise Edition Features<a class="headerlink" href="#scidb-enterprise-edition-features" title="Permalink to this headline">¶</a></h2>
<p>SciDB Enterprise Edition features can be used directly as any other
operators. One special case is the <code class="docutils literal"><span class="pre">set_namespace</span></code> operator. The
operator alters the <code class="docutils literal"><span class="pre">DB</span></code> object on which it is called. The effect
persists until the next call to <code class="docutils literal"><span class="pre">set_namespace</span></code>. The operator can be
called directly (i.g., <code class="docutils literal"><span class="pre">db.set_namespace</span></code>) or through the <code class="docutils literal"><span class="pre">iquery</span></code>
function. No immediate query is executed in SciDB, but the new
namespace will take effect for any subsequent SciDB queries:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
<span class="go">scidb_url  = http://localhost:8080</span>
<span class="go">scidb_auth = None</span>
<span class="go">http_auth  = None</span>
<span class="go">namespace  = None</span>
<span class="go">verify     = None</span>
</pre></div>
</div>
<p>Notice the <code class="docutils literal"><span class="pre">namespace</span></code> field of the <code class="docutils literal"><span class="pre">DB</span></code> instance.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">set_namespace</span><span class="p">(</span><span class="s1">&#39;private&#39;</span><span class="p">)</span>
<span class="gp">... </span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
<span class="gp">... </span>
<span class="go">scidb_url  = http://localhost:8080</span>
<span class="go">scidb_auth = None</span>
<span class="go">http_auth  = None</span>
<span class="go">namespace  = private</span>
<span class="go">verify     = None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">show_namespace</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="s1">&#39;val&#39;</span><span class="p">]</span>
<span class="gp">... </span>
<span class="go">&#39;private&#39;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">iquery</span><span class="p">(</span><span class="s2">&quot;set_namespace(&#39;public&#39;)&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
<span class="go">scidb_url  = http://localhost:8080</span>
<span class="go">scidb_auth = None</span>
<span class="go">http_auth  = None</span>
<span class="go">namespace  = public</span>
<span class="go">verify     = None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">show_namespace</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="s1">&#39;val&#39;</span><span class="p">]</span>
<span class="gp">... </span>
<span class="go">&#39;public&#39;</span>
</pre></div>
</div>
<p>For convenience, an initial namespace can be provided at connection
time:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">db_ssl</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="s1">&#39;https://localhost:8083&#39;</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">namespace</span><span class="o">=</span><span class="s1">&#39;public&#39;</span><span class="p">)</span>
<span class="gp">... </span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">db_ssl</span><span class="p">)</span>
<span class="gp">... </span>
<span class="go">scidb_url  = https://localhost:8083</span>
<span class="go">scidb_auth = None</span>
<span class="go">http_auth  = None</span>
<span class="go">namespace  = public</span>
<span class="go">verify     = False</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">SciDB-Py</a></h1>



<p class="blurb">Python library for SciDB</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=Paradigm4&repo=SciDB-Py&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a href="https://travis-ci.org/Paradigm4/SciDB-Py">
    <img
        alt="https://secure.travis-ci.org/Paradigm4/SciDB-Py.svg?branch=master"
        src="https://secure.travis-ci.org/Paradigm4/SciDB-Py.svg?branch=master"
    />
</a>
</p>


<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#quick-start">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#connect-to-scidb">Connect to SciDB</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#advanced-connection">Advanced Connection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#scidb-arrays">SciDB Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scidb-operators">SciDB Operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#download-data-from-scidb">Download Data from SciDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="#upload-data-to-scidb">Upload Data to SciDB</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-iquery-function">The iquery Function</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Download Data from SciDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Upload Data to SciDB</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#upload-numpy-arrays">Upload NumPy Arrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="#upload-binary-data">Upload Binary Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#upload-data-files">Upload Data Files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#scidb-enterprise-edition-features">SciDB Enterprise Edition Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://paradigm4.atlassian.net/wiki/spaces/scidb/overview">SciDB 18.1 Docs</a></li>
    
    <li class="toctree-l1"><a href="https://github.com/Paradigm4/SciDB-Py/issues">Bug Reports</a></li>
    
    <li class="toctree-l1"><a href="http://forum.paradigm4.com/c/scidb-py">Support Forum</a></li>
    
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Paradigm4.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/guide.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>